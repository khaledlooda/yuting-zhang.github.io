---
layout: post
title:  "UVa - Power Strings"
date:   2016-03-20 22:20 -0500
categories: UVa
---

**Problem:** [Power Strings]

**Solution:**
An easy problem if you know the math and algorithms involved. Simply put, this problem asks for the period of a string. 
The period of a string is defined as the length of the shortest substring which, when concatenated repeatedly, can reconstruct the 
original string. For examples, the period of \\(AAAA\\) is 1, since we can repeat \\(A\\) 4 times to get the original string;
The period of \\(ABAB\\) is 2; and the period of \\(ABC\\) is 3, the original string itself.
 
The algorithm to calculate the period is as follows:
Let \\(L\\) be the length of the string, and \\(\pi\\) be the back table for such string 
(refer to KMP algorithm for details about back table). We have period \\(r\\) be
\\[r = max\\{p - \pi[p] \,|\, 1 \le p \le L\\}\\]
If \\(L \, \% \, r \neq 0\\), then \\(r = L\\).

We can use the above algorithm to easily solve this problem.

**Note:**
Using C++ string may cause runtime error due to huge input size. Use an char buffer instead if you have run into runtime error.

**Source Code:**
{% highlight C++ %}
#include <iostream>
#include <cstdio>
#include <vector>
#include <cstring>

using namespace std;

int main(){
    char line[1000001];
    while (scanf(" %s ", line) == 1 && strcmp(line, ".")){
        int length = strlen(line);
        vector<int> pi(length + 1, 0);
        for (int i = 2; i <= length; i++){
            int k = pi[i - 1];
            while (k > 0 && line[k] != line[i - 1])
                k = pi[k];
            if (line[k] == line[i - 1])
                pi[i] = k + 1;
            else
                pi[i] = 0;
        }

        int period = 0;
        for (int i = 1; i <= length; i++)
            if (i - pi[i] > period)
                period = i - pi[i];

        if (length % period != 0)
            period = length;
        printf("%d\n", length / period);
    }
}

{% endhighlight %}

[Power Strings]: https://uva.onlinejudge.org/index.php?option=com_onlinejudge&Itemid=8&category=24&page=show_problem&problem=1239
